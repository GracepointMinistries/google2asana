## Overview
AsanaSync is an app made to sync permissions from google groups over to Asana teams. For groups that have their organizational structure tied to google groups (and use email aliases for various teams), this is a way to make it easy to give permissions for an Asana team to the people on a google alias.

## Features
A google group alias of "admins" can be supplied for which each user on that alias will be added to every team within the Asana org.
An email-prefix filter can be specified which will exclude any/all email addresses with that prefix from being added to teams (ie, if google groups point to other groups in a tree-like fashion, if those other groups all have a character like '_' at the beginning, you can specify that those sub-groups should be ignored when doing the sync
In order that AsanaSync does not remove permissions for members that were added by hand (ie by a user and not the script), a database of who was added to which team by the script is maintained. So only users that were added by the script will be removed by the script.

## Database setup
AsanaSync will keep its log of users added in a MYSQL database. The command to create the table is:  
`create table asanaSyncLog(user_id BIGINT, user_name VARCHAR(255), team_id BIGINT, team_name VARCHAR(255), PRIMARY KEY (user_id, team_id))`

## Asana Personal Access Token
The Asana Personal Access Token can be generated by following directions [here](https://asana.com/guide/help/api/api). NOTE: the account to which the Asana Personal Access Token is linked to MUST BE on every team (ie that person must be a member of each team) in order for permissions to be given to add/remove members via the script.

## Config
Config parameters can be passed in either via a yaml file (see config.yaml for template) or via environment variables. Environment variables should look like:  
`ASANASYNC_WORKSPACE_NAME=domain.org
ASANASYNC_EMAIL_PREFIX_FILTER=_
ASANASYNC_ADMIN_ALIAS=admins@domain.org
ASANASYNC_GOOGLE_PEM_EMAIL=googlegroup@googlegroup.iam.gserviceaccount.com
ASANASYNC_GOOGLE_PEM_SUBJECT=domain_admin@domain.org
ASANASYNC_MYSQL_CONFIG=dbuser:password@/db_name
ASANASYNC_ASANA_PERSONAL_ACCESS_TOKEN=0/9acc...
ASANASYNC_GOOGLE_PEM_VALUE=Bag Attributes friendlyName: privatekey...`

## Future improvements:
Check descriptions for workspaces and projects and add any aliases in there to permission for said workspace or project (but no need to add entries for folks already in a higher level)

## Contributing
We use [govendor](https://github.com/kardianos/govendor) to vendor all our dependancies.
